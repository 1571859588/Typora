云存储

开发者可以在客户端和云函数端通过API直接使用云存储

# 4.1管理文件

文件名命名限制

* 不能为空
* 不能以/开头
* 不能出现连续/
* 编码长度最大为850字节
* 推荐使用大小写英文字母、数字，即[a~z, A ~Z,0 ~9]和符号-、！、_、. 、*及其组合
* 不支持ASCII控制字符的箭头符号
* 若用户上传的文件或文件夹名字带有中文，在访问和请求这个文件或文件夹时，中文部分将按照URL Encode规则转换为百分号编码
* 不建议使用的特殊字符'、^、"、\、{、}、[、]、~ 、%、#、>、<以及ASCII128~255十进制
* 可能需特殊处理后再使用的特殊字符为,、:、;、=、&、$、@、+、?(空格)及ASCII字符范围00 ~ 1F，十六进制（0 ~ 31，十进制）以及7F（127十进制）

# 4.2 存储API

存储操作API指令

| 指令           | 说明         |
| -------------- | ------------ |
| uploadFile     | 上传文件     |
| downloadFile   | 下载文件     |
| deleteFile     | 删除文件     |
| getTempFileURL | 换取临时链接 |

# 4.3 存储操作

## 上传文件

微信小程序端可以调用wx.cloud.uploadFile()上传文件

```js
wx.cloud.uploadFile({
    cloudPath:'example.png',
    filePath:''
}).then(res=>{
    //get resource ID
    console.log(res.fileID)
}).catch(error=>{
    //handle error
})
```

文件上传成功后会获得文件唯一标识符，即文件ID，后续操作都基于文件ID而不是URL

## 下载文件

可以根据文件ID下载文件，用户仅可下载其有访问权限的文件

```js
wx.cloud.downloadFile({
    fileID:''
}).then(res=>{
    //get temp file path
    console.log(res.tempFilePath)
  
}).catch(error=>{
    //handle error
})
```

## 删除文件

```js
wx.cloud.deleteFile({
    fileList:['fileID']
}).then(res=>{
    //handle success
    console.log(res.fileList)

}).catch(error=>{
    //handle error
})
```

## 换取临时链接

可以根据文件ID换取临时文件链接，文件链接有效期为两小时

```js
wx.cloud.getTempFileURL({
    fileList:[{
        fileID:'',
        maxAge:60*60,//one hour

    }]
}).then(res=>{
    //get temp file URL
    console.log(res.fileList)
}).catch(error=>{
    //handle error
})
```

# 4.4 云存储案例
